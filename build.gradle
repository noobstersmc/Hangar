/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */
plugins{
    id 'java'
    id 'maven-publish'
    id 'com.github.johnrengelman.shadow' version '6.0.0'
    id "io.freefair.lombok" version '5.3.0'
}

/** Set java target and compatibility */
sourceCompatibility = 11
targetCompatibility = 11

/** Compiling and  Javadocs enconding options */
compileJava.options.encoding = 'UTF-8'
javadoc {
    options.encoding = 'UTF-8'
}

/** Group and versioning for distribution */
group = 'net.noobsters'
version = '0.1B-SNAPSHOT'

/** Publishing */
publishing {
    publications {
        maven(MavenPublication) {
            from components.java
        }
    }
    // Private Noobsters Repo, currently down.
    repositories {
        maven {
            url 'https://dev.repo.noobsters.net/'
            credentials {
                username "${hynx_usr}"
                password "${hynx_pass}"
            }
        }
    }
}

/** Repos */
repositories {
    mavenCentral()
    jcenter()
    maven { url 'https://papermc.io/repo/repository/maven-public/' }
    maven { url 'https://libraries.minecraft.net/' }
    maven { url 'https://plugins.gradle.org/m2' }
    maven { url 'https://jitpack.io' }
    maven { url 'https://repo.aikar.co/content/groups/aikar/' }
    maven { url 'https://oss.sonatype.org/content/groups/public/'}
    maven {
        url 'https://dev.repo.noobsters.net/'
        credentials {
            username "${hynx_usr}"
            password "${hynx_pass}"
        }
    }
}


/** Dependencies */
dependencies {
    //Unirest
    compile 'com.konghq:unirest-java:3.11.09'
    //Paper
    compileOnly 'com.destroystokyo.paper:paper-api:1.16.5-R0.1-SNAPSHOT'
    //Lombok
	compileOnly 'org.projectlombok:lombok:1.18.12'
	annotationProcessor 'org.projectlombok:lombok:1.18.12'
	testCompileOnly 'org.projectlombok:lombok:1.18.12'
	testAnnotationProcessor 'org.projectlombok:lombok:1.18.12'
    //ACF
    compile 'co.aikar:acf-paper:0.5.0-SNAPSHOT'
    //Scoreboard and GUI by Micky, maybe use helper by lucko?
    compile 'fr.mrmicky:FastBoard:1.1.0'
    //Jedis
    compile 'redis.clients:jedis:3.3.0'
    //LETUCE
    compile 'io.lettuce:lettuce-core:6.0.1.RELEASE'
    //okhttp
    implementation("com.squareup.okhttp3:okhttp:4.9.0")
    implementation 'com.google.code.gson:gson:2.8.6'
    //Caffeine
    implementation 'com.github.ben-manes.caffeine:caffeine:3.0.3'
    //Vault
    compileOnly 'com.github.MilkBowl:VaultAPI:1.7'
    //Luckperms
    compileOnly 'net.luckperms:api:5.1'
    //Helper
    compileOnly 'me.lucko:helper:5.6.5'
    //RapidInv
	implementation 'com.github.noobstersmc:RapidInv:v0.0.2.1'
    // https://mvnrepository.com/artifact/org.apache.commons/commons-text
    implementation 'org.apache.commons:commons-text:1.9'
    
   implementation "net.kyori:adventure-text-minimessage:4.1.0-SNAPSHOT"


}

/** Process Resources methods to include .ymls in resource directory into the final jar */
processResources {
    from(sourceSets.main.resources.srcDirs) {
        expand 'version': project.version
        include 'plugin.yml'
    }
}
/** Include sources jar on build. */
task sourcesJar(type: Jar, dependsOn: classes) {
    classifier = 'sources'
    from sourceSets.main.allSource
}
/** Include javadocs on build. */
task javadocJar(type: Jar, dependsOn: javadoc) {
    classifier = 'javadoc'
    from javadoc.destinationDir
}
/** Add to the output artifacts. */
artifacts {
    archives sourcesJar
    archives javadocJar
}

/** Relocations for fatjar */
shadowJar {
    relocate 'co.aikar.commands', 'shadded.acf'
    relocate 'co.aikar.locales', 'shadded.acf.locales'
    relocate 'fr.mrmicky', 'shadded.gui'
    relocate 'fr.mrmicky.fastboard', 'us.jcedeno.hangar.paper.scoreboard'
    relocate 'okhttp3', 'shadded.okhttp3'
    relocate 'okio', 'shadded.okio'
    relocate 'kotlin', 'shadded.kotlin'
    relocate 'com.github.benmanes.caffeine', 'shadded.com.github.benmanes.caffeine'
    relocate 'com.google.errorprone', 'shadded.com.google.errorprone'
    relocate 'io.netty', 'shadded.io.netty'
    relocate 'io.lettuce', 'shadded.io.lettuce'
}
// Ensure build calls shadowJar to generate the fatjar
build.dependsOn shadowJar


